# Copilot Instructions for HexGlobeProject

This document helps AI coding agents quickly understand and navigate the HexGlobeProject codebase, focusing on Unity-specific patterns, key modules, and developer workflows.

## 1. Project Structure
- Assets/Scripts/HexMap: `GlobeGrid.cs`, `HexCell.cs`, `PentagonCell.cs` handle raw grid data.
- Assets/Scripts/Graphics: `MeshGenerator.cs` builds and updates Unity meshes via `MeshFilter`.
- Assets/Scripts/TerrainSystem: procedural terrain via `TerrainConfig` (ScriptableObject), `TerrainRoot` (ExecuteAlways), and polymorphic `TerrainHeightProviderBase` subclasses.
- Assets/Scripts/TerrainSystem/LOD: LOD bake & split logic in `PlanetLodManager`, `TileFade`, and data classes.

## 2. Key Patterns & Conventions
- ScriptableObject configs: use **Create > HexGlobe/Terrain Config** to instantiate `TerrainConfig` asset. Fields are annotated with `[Tooltip]`, `[Header]`, and `SerializeReference` for polymorphic height providers.
- Context menus: `TerrainRoot.Rebuild()` and `PlanetLodManager.BakeBaseDepth` expose operations under component right-click menus.
- ExecuteAlways: `TerrainRoot` runs in editor mode for rapid iteration without entering play mode.
- Mesh workflow: build vertex arrays → assign to `MeshFilter.sharedMesh` → call `RecalculateNormals()` or use radial normals via config.

## 3. Build & Run
1. Open `HexGlobeProject.sln` in Unity 2020+ (see ProjectSettings/ProjectVersion.txt).
2. Open `MainScene.unity` and locate the `HexGlobe` root GameObject.
3. Assign a `TerrainConfig` asset and a material to the `TerrainRoot` component.
4. Use **Rebuild Terrain** context menu to generate base patches.
5. In play mode, adjust camera or enable `autoBakeOnStart` on `PlanetLodManager` for LOD tests.

## 4. Editing & Debugging
- Modify `TerrainConfig` in Inspector to tune sea level, LOD depths, shoreline detail, etc.
- Toggle `debugLogBake`, `gizmoWireTiles`, or `debugTint` in `PlanetLodManager` to visualize bake progress and tile boundaries.
- Use `GlobeGrid` component parameters (`gridWidth`, `gridHeight`, `cellSize`) on a GameObject to generate a flat hex grid for testing outside sphere.

## 5. Integration Points
- Height sampling: any `TerrainHeightProviderBase` must implement `Sample(Vector3 dir)` and can optionally implement `IOctaveSampler` for multi-octave noise.
- Shader globals: call `TerrainShaderGlobals.Apply(config, material)` after rebuilding to sync properties manually (no automatic `_Shader.SetGlobal*`).
- Ocean mesh: `TerrainRoot.CreateOceanIfNeeded` uses a simple icosphere algorithm for sea surface.

## 6. Project-Specific Notes
- Exactly 12 pentagonal cells are generated by geodesic sphere math (see mesh subdivision in `TerrainRoot.BuildIcoSphere`).
- LOD split logic uses `splitEnterFactor` and `splitExitFactor` to control quadtree splits near camera (see `PlanetLodManager`).
- Scripts rely on Unity Editor attributes; avoid moving files without updating namespace imports.

---

*Please review and suggest any clarifications or missing details specific to this project.*
